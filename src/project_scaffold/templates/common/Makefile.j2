.PHONY: up down logs build{% if include_alembic %} migrate migration{% endif %} test lint format{% if frontend_type == "react" %} frontend-dev frontend-build{% endif %}

up:
	docker compose up -d

down:
	docker compose down

logs:
	docker compose logs -f

build:
	docker compose build
{% if include_alembic %}

migrate:
	docker compose exec api alembic upgrade head

migration:
	docker compose exec api alembic revision --autogenerate -m "$(msg)"
{%- endif %}

test:
	docker compose exec api pytest -v

lint:
	docker compose exec api ruff check . && docker compose exec api ruff format --check .

format:
	docker compose exec api ruff format .
{% if frontend_type == "react" %}

frontend-dev:
	docker compose exec frontend npm run dev

frontend-build:
	docker compose exec frontend npm run build
{%- endif %}
